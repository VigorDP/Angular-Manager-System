<page-header title="组织架构" autoBreadcrumb="false" [action]="action">
  <ng-template #action>
    <button nz-button (click)="selectedRow={};dateRange=null;getTagData();addOrEditOrView(modalContent,'add')"
      [nzType]="'primary'">
      <i nz-icon nzType="plus"></i>
      <span>新建成员</span>
    </button>
    <button nz-button [nzType]="'primary'" (click)="showArchitectTree=true">
      <i nz-icon nzType="setting"></i>
      <span>部门管理</span>
    </button>
  </ng-template>
</page-header>

<nz-card [nzBordered]="false">
  <form nz-form se-container labelWidth="130">
    <se label="姓名" col="4">
      <input nz-input placeholder="请输入" [(ngModel)]="query.title" name="title" />
    </se>
    <se label="手机号" col="4">
      <input nz-input placeholder="请输入" [(ngModel)]="query.title" name="title" />
    </se>
    <se col="4">
      <button nz-button [nzType]="'primary'" (click)="getData(1)" [nzLoading]="loading">查询</button>
      <button nz-button (click)="reset()" [disabled]="loading">重置</button>
    </se>
  </form>
</nz-card>

<nz-card [nzBordered]="false">
  <st #st [data]="data" [total]="total" [ps]="query.pageSize" [pi]="query.pageNo" [columns]="columns" [page]="pages"
    [loading]="loading" (change)="stChange($event)" [scroll]="{x: '1000px'}"></st>
</nz-card>

<!--新增人员-->
<ng-template #modalContent>
  <form nz-form se-container labelWidth="130">
    <se label="姓名" col="2" required>
      <input nz-input placeholder="请输入" [(ngModel)]="selectedRow.name" name="name" />
    </se>
    <se label="性别" col="2" required>
      <nz-select [(ngModel)]="selectedRow.tag" name="tag" [nzPlaceHolder]="'请选择'">
        <nz-option *ngFor="let i of genderList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
      </nz-select>
    </se>
    <se label="手机号" col="2" required>
      <input nz-input placeholder="请输入" [(ngModel)]="selectedRow.descr" name="descr" />
    </se>
    <se label="出生日期" col="2" *ngIf="selectedRow.isTop">
      <nz-date-picker class="input" [nzStyle]="{ width: '100%' }" nzFormat="yyyy-MM-dd" nzPlaceHolder="开始日期"
        [(ngModel)]="property.beginDate"></nz-date-picker>
    </se>
    <se label="密码" col="2" required>
      <input nz-input placeholder="请输入" type="password" [(ngModel)]="selectedRow.pwd" name="pwd" />
    </se>
    <se label="确认密码" col="2" required>
      <input nz-input placeholder="请输入" type="password" [(ngModel)]="selectedRow.pwdRepeat" name="pwdRepeat" />
    </se>
    <se label="所在部门" col="2" required>
      <nz-select [(ngModel)]="selectedRow.tag" name="tag" [nzPlaceHolder]="'请选择'">
        <nz-option *ngFor="let i of tagList" [nzLabel]="i.name" [nzValue]="i.name"></nz-option>
      </nz-select>
    </se>
    <se label="所属岗位" col="2" required>
      <nz-select [(ngModel)]="selectedRow.tag" name="tag" [nzPlaceHolder]="'请选择'">
        <nz-option *ngFor="let i of tagList" [nzLabel]="i.name" [nzValue]="i.name"></nz-option>
      </nz-select>
    </se>
    <se label="证件类型" col="2">
      <nz-select [(ngModel)]="selectedRow.credentialType" name="credentialType" [nzPlaceHolder]="'请选择'">
        <nz-option *ngFor="let i of cardList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
      </nz-select>
    </se>
    <se label="证件号码" col="2">
      <input nz-input placeholder="请输入" [(ngModel)]="selectedRow.credentialNo"
        (ngModelChange)="inputChange$.next($event)" name="credentialNo" />
    </se>
    <se label="邮箱" col="2">
      <input nz-input placeholder="请输入" [(ngModel)]="selectedRow.name" name="name" />
    </se>
    <se label="职位" col="2">
      <input nz-input placeholder="请输入" [(ngModel)]="selectedRow.name" name="name" />
    </se>
    <se label="民族" col="2">
      <input nz-input placeholder="请输入" [(ngModel)]="selectedRow.name" name="name" />
    </se>
    <se label="文化程度" col="2">
      <nz-select [(ngModel)]="selectedRow.educationLevel" name="educationLevel" [nzPlaceHolder]="'请选择'">
        <nz-option *ngFor="let i of studyList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
      </nz-select>
    </se>
    <se label="户籍" col="1">
      <div style="display: flex;justify-content: space-between;margin-top: 4px;">
        <nz-select [(ngModel)]="selectedRow.provinceCode" name="provinceCode" [nzPlaceHolder]="'请选择省份'"
          (ngModelChange)="handleProvinceSelected($event)">
          <nz-option *ngFor="let i of provinceList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
        </nz-select>
        <nz-select [(ngModel)]="selectedRow.cityCode" name="cityCode" [nzPlaceHolder]="'请选择城市
        '" (ngModelChange)="handleCitySelected($event)">
          <nz-option *ngFor="let i of cityList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
        </nz-select>
        <nz-select [(ngModel)]="selectedRow.districtCode" name="districtCode" [nzPlaceHolder]="'请选择区/县'">
          <nz-option *ngFor="let i of areaList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
        </nz-select>
      </div>
    </se>
    <se label="籍贯" col="1">
      <div style="display: flex;justify-content: space-between;margin-top: 4px;">
        <nz-select [(ngModel)]="selectedRow.provinceCode2" name="provinceCode2" [nzPlaceHolder]="'请选择省份'"
          (ngModelChange)="handleProvinceSelected($event)">
          <nz-option *ngFor="let i of provinceList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
        </nz-select>
        <nz-select [(ngModel)]="selectedRow.cityCode2" name="cityCode2" [nzPlaceHolder]="'请选择城市
        '" (ngModelChange)="handleCitySelected($event)">
          <nz-option *ngFor="let i of cityList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
        </nz-select>
        <nz-select [(ngModel)]="selectedRow.districtCode2" name="districtCode2" [nzPlaceHolder]="'请选择区/县'">
          <nz-option *ngFor="let i of areaList" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
        </nz-select>
      </div>
    </se>
    <se label="备注" col="1">
      <input nz-input placeholder="请输入" [(ngModel)]="selectedRow.name" name="name" />
    </se>
  </form>
</ng-template>

<!--部门管理-->
<ngx-architect-tree [show]="showArchitectTree" label="部门" [listApi]="api.getOrgStructureList"
  [saveApi]="api.saveStructure" [deleteApi]="api.deleteOrgStructure" (closeEvent)="showArchitectTree=false">
</ngx-architect-tree>
